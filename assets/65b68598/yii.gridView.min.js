!function(e){function i(i,t,r,n,l){var a=i.attr("id"),c=o[a];if(void 0!==c&&void 0!==c[t]){var f=c[t];e(document).off(f.event,f.selector)}void 0===c&&(o[a]={}),e(document).on(r,n,l),o[a][t]={event:r,selector:n}}e.fn.yiiGridView=function(i){return l[i]?l[i].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof i&&i?(e.error("Method "+i+" does not exist in jQuery.yiiGridView"),!1):l.init.apply(this,arguments)};var t={filterUrl:void 0,filterSelector:void 0,filterOnFocusOut:!0},r={},n={beforeFilter:"beforeFilter",afterFilter:"afterFilter"},o={},l={init:function(n){return this.each(function(){var o=e(this),a=e.extend({},t,n||{}),c=o.attr("id");void 0===r[c]&&(r[c]={}),r[c]=e.extend(r[c],{settings:a});var f=!1;i(o,"filter","change.yiiGridView keydown.yiiGridView",a.filterSelector,function(e){if("keydown"===e.type){if(13!==e.keyCode)return;f=!0}else if(f)return void(f=!1);return!(!a.filterOnFocusOut&&"keydown"!==e.type)&&(l.applyFilter.apply(o),!1)})})},applyFilter:function(){var i=e(this),t=r[i.attr("id")].settings,o={};e.each(e(t.filterSelector).serializeArray(),function(){this.name in o||(o[this.name]=[]),o[this.name].push(this.value)});var l=Object.keys(o);e.each(yii.getQueryParams(t.filterUrl),function(i,t){-1===l.indexOf(i)&&-1===l.indexOf(i.replace(/\[\d*\]$/,""))&&(e.isArray(t)||(t=[t]),i in o?e.each(t,function(t,r){e.inArray(r,o[i])&&o[i].push(r)}):o[i]=t)});var a=t.filterUrl.indexOf("?"),c=a<0?t.filterUrl:t.filterUrl.substring(0,a),f=t.filterUrl.indexOf("#");a>=0&&f>=0&&(c+=t.filterUrl.substring(f)),i.find("form.gridview-filter-form").remove();var d=e("<form/>",{action:c,method:"get",class:"gridview-filter-form",style:"display:none","data-pjax":""}).appendTo(i);e.each(o,function(i,t){e.each(t,function(t,r){d.append(e("<input/>").attr({type:"hidden",name:i,value:r}))})});var s=e.Event(n.beforeFilter);i.trigger(s),!1!==s.result&&(d.submit(),i.trigger(n.afterFilter))},setSelectionColumn:function(t){var n=e(this),o=e(this).attr("id");if(void 0===r[o]&&(r[o]={}),r[o].selectionColumn=t.name,t.multiple&&t.checkAll){var l="#"+o+" input[name='"+t.checkAll+"']",a=t.class?"input."+t.class:"input[name='"+t.name+"']",c="#"+o+" "+a+":enabled";i(n,"checkAllRows","click.yiiGridView",l,function(){n.find(a+":enabled").prop("checked",this.checked)}),i(n,"checkRow","click.yiiGridView",c,function(){var e=n.find(a).length==n.find(a+":checked").length;n.find("input[name='"+t.checkAll+"']").prop("checked",e)})}},getSelectedRows:function(){var i=e(this),t=r[i.attr("id")],n=[];return t.selectionColumn&&i.find("input[name='"+t.selectionColumn+"']:checked").each(function(){n.push(e(this).parent().closest("tr").data("key"))}),n},destroy:function(){var i=[".yiiGridView",n.beforeFilter,n.afterFilter].join(" ");this.off(i);var t=e(this).attr("id");return e.each(o[t],function(i,t){e(document).off(t.event,t.selector)}),delete r[t],this},data:function(){var i=e(this).attr("id");return r[i]}}}(window.jQuery);